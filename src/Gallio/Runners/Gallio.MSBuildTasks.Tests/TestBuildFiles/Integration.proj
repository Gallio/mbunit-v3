<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <UsingTask AssemblyFile="..\bin\Gallio.MSBuildTasks.dll" TaskName="Gallio" />

  <PropertyGroup>
    <TestAssembly>..\bin\Gallio.TestResources.MbUnit2.dll</TestAssembly>
  </PropertyGroup>
  
  <Target Name="PassingTests">
    <Gallio Filter="Type=PassingTests" Assemblies="$(TestAssembly)"
            PluginDirectories="$(GallioPath)">
      <Output TaskParameter="ExitCode" PropertyName="ExitCode" />
    </Gallio>
    
    <Error Text="Expected successful result code, was '$(ExitCode)'."
           Condition="'$(ExitCode)' != '0'" />
  </Target>
  
  <Target Name="FailingTests">
    <Gallio Filter="Type=FailingFixture" Assemblies="$(TestAssembly)"
            PluginDirectories="$(GallioPath)" />
    
    <Error Text="Expected failure result code, so should not have reached this point." />
  </Target>
  
  <Target Name="FailingTestsWithIgnoreFailures">
    <Gallio Filter="Type=FailingFixture" Assemblies="$(TestAssembly)" IgnoreFailures="true"
            PluginDirectories="$(GallioPath)">
      <Output TaskParameter="ExitCode" PropertyName="ExitCode" />
    </Gallio>
    
    <Error Text="Expected failure result code, was '$(ExitCode)'."
           Condition="'$(ExitCode)' != '1'" />
  </Target>
  
  <Target Name="NoAssemblies">
    <Gallio Assemblies=""
            PluginDirectories="$(GallioPath)">
      <Output TaskParameter="ExitCode" PropertyName="ExitCode" />
    </Gallio>
    
    <Error Text="Expected NoTests result code, was '$(ExitCode)'."
           Condition="'$(ExitCode)' != '16'" />
  </Target>

  <Target Name="NoTests">
    <Gallio Filter="Type=NoSuchType" Assemblies="$(TestAssembly)"
            PluginDirectories="$(GallioPath)">
      <Output TaskParameter="ExitCode" PropertyName="ExitCode" />
    </Gallio>
    
    <Error Text="Expected NoTests result code, was '$(ExitCode)'."
           Condition="'$(ExitCode)' != '16'" />
  </Target>

  <Target Name="NoFilter">
    <Gallio Filter="" Assemblies="$(TestAssembly)" IgnoreFailures="true"
            PluginDirectories="$(GallioPath)">
      <Output TaskParameter="ExitCode" PropertyName="ExitCode" />
    </Gallio>
    
    <Error Text="Expected failure result code, was '$(ExitCode)'."
           Condition="'$(ExitCode)' != '1'" />
  </Target>
</Project>