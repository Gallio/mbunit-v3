<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:VS="http://schemas.microsoft.com/wix/VSExtension">
    <Fragment>

        <!-- ==================================================================== -->

        <!-- Pick up Visual Studio properties from WixVSExtension -->
        <PropertyRef Id="VS2005_ITEMTEMPLATES_DIR" />
        <PropertyRef Id="VS2005_PROJECTTEMPLATES_DIR" />

        <DirectoryRef Id="TARGETDIR">

            <Directory Id="VS2005_ITEMTEMPLATES_DIR" Name="ItemTemplates.VS2005">
                <Directory Id="VS2005.ItemTemplates.CS" Name="CSharp">
                    <Directory Id="VS2005.ItemTemplates.CS.Test" Name="Test">
                        <Component Id="VS2005.MbUnit3.TestFixtureTemplate.CSharp.zip" Guid="7BB50DCA-BFC5-4303-ACE3-5042927FAD55">
                            <File Id="VS2005.MbUnit3.TestFixtureTemplate.CSharp.zip" Source="$(var.GallioTargetDir)\extras\Templates\VS2005\ItemTemplates\CSharp\Test\MbUnit3.TestFixtureTemplate.CSharp.zip" KeyPath="yes" />
                        </Component>
                    </Directory>
                </Directory>
                <Directory Id="VS2005.ItemTemplates.VB" Name="VisualBasic">
                    <Directory Id="VS2005.ItemTemplates.VB.Test" Name="Test">
                        <Component Id="VS2005.MbUnit3.TestFixtureTemplate.VisualBasic.zip" Guid="378B0392-A815-4672-94F6-E8CBA5E640FB">
                            <File Id="VS2005.MbUnit3.TestFixtureTemplate.VisualBasic.zip" Source="$(var.GallioTargetDir)\extras\Templates\VS2005\ItemTemplates\VisualBasic\Test\MbUnit3.TestFixtureTemplate.VisualBasic.zip" KeyPath="yes" />
                        </Component>
                    </Directory>
                </Directory>
            </Directory>
            <Directory Id="VS2005_PROJECTTEMPLATES_DIR" Name="ProjectTemplates.VS2005">
                <Directory Id="VS2005.ProjectTemplates.CS" Name="CSharp">
                    <Directory Id="VS2005.ProjectTemplates.CS.Test" Name="Test">
                        <Component Id="VS2005.MbUnit3.TestProjectTemplate.CSharp.zip" Guid="1F9437C7-BCD1-4327-BBFE-5C67088393A0">
                            <File Id="VS2005.MbUnit3.TestProjectTemplate.CSharp.zip" Source="$(var.GallioTargetDir)\extras\Templates\VS2005\ProjectTemplates\CSharp\Test\MbUnit3.TestProjectTemplate.CSharp.zip" KeyPath="yes" />
                        </Component>
                    </Directory>
                </Directory>
                <Directory Id="VS2005.ProjectTemplates.VB" Name="VisualBasic">
                    <Directory Id="VS2005.ProjectTemplates.VB.Test" Name="Test">
                        <Component Id="VS2005.MbUnit3.TestProjectTemplate.VisualBasic.zip" Guid="{07CC045C-C889-4f4f-9AAD-47C49CD04C8E}">
                            <File Id="VS2005.MbUnit3.TestProjectTemplate.VisualBasic.zip" Source="$(var.GallioTargetDir)\extras\Templates\VS2005\ProjectTemplates\VisualBasic\Test\MbUnit3.TestProjectTemplate.VisualBasic.zip" KeyPath="yes" />
                        </Component>
                    </Directory>
                </Directory>
            </Directory>

        </DirectoryRef>

        <Feature Id="feat_MbUnit3.Templates.VS2005" Title="Visual Studio 2005 Templates" Level="0" 
                 Description="Installs the MbUnit v3 Visual Studio 2005 templates.">
            <Condition Level="1">                 
                 VS2005_ITEMTEMPLATES_DIR and VS2005_PROJECTTEMPLATES_DIR
            </Condition>
            <ComponentRef Id="VS2005.MbUnit3.TestFixtureTemplate.CSharp.zip" />
            <ComponentRef Id="VS2005.MbUnit3.TestFixtureTemplate.VisualBasic.zip" />
            <ComponentRef Id="VS2005.MbUnit3.TestProjectTemplate.CSharp.zip" />
            <ComponentRef Id="VS2005.MbUnit3.TestProjectTemplate.VisualBasic.zip" />
        </Feature>

        <!-- ==================================================================== -->

        <!-- Pick up Visual Studio properties from WixVSExtension -->
        <PropertyRef Id="VS90_ITEMTEMPLATES_DIR" />
        <PropertyRef Id="VS90_PROJECTTEMPLATES_DIR" />

        <DirectoryRef Id="TARGETDIR">

            <Directory Id="VS90_ITEMTEMPLATES_DIR" Name="ItemTemplates.VS90">
                <Directory Id="VS90.ItemTemplates.CS" Name="CSharp">
                    <Directory Id="VS90.ItemTemplates.CS.Test" Name="Test">
                        <Component Id="VS90.MbUnit3.TestFixtureTemplate.CSharp.zip" Guid="45F61E32-1A5A-4bc0-922F-1162D145A884">
                            <File Id="VS2008.MbUnit3.TestFixtureTemplate.CSharp.zip" Source="$(var.GallioTargetDir)\extras\Templates\VS2008\ItemTemplates\CSharp\Test\MbUnit3.TestFixtureTemplate.CSharp.zip" KeyPath="yes" />
                        </Component>
                    </Directory>
                </Directory>
                <Directory Id="VS90.ItemTemplates.VB" Name="VisualBasic">
                    <Directory Id="VS90.ItemTemplates.VB.Test" Name="Test">
                        <Component Id="VS2008.MbUnit3.TestFixtureTemplate.VisualBasic.zip" Guid="7EA51EA1-B9CC-4046-A06C-9209824D61B2">
                            <File Id="VS2008.MbUnit3.TestFixtureTemplate.VisualBasic.zip" Source="$(var.GallioTargetDir)\extras\Templates\VS2008\ItemTemplates\VisualBasic\Test\MbUnit3.TestFixtureTemplate.VisualBasic.zip" KeyPath="yes" />
                        </Component>
                    </Directory>
                </Directory>
            </Directory>

            <Directory Id="VS90_PROJECTTEMPLATES_DIR" Name="ProjectTemplates.VS90">
                <Directory Id="VS90.ProjectTemplates.CS" Name="CSharp">
                    <Directory Id="VS90.ProjectTemplates.CS.Test" Name="Test">
                        <Component Id="VS2008.MbUnit3.TestProjectTemplate.CSharp.zip" Guid="{00EB4409-61A2-4065-B019-7B97AA240825}">
                            <File Id="VS2008.MbUnit3.TestProjectTemplate.CSharp.zip" Source="$(var.GallioTargetDir)\extras\Templates\VS2008\ProjectTemplates\CSharp\Test\MbUnit3.TestProjectTemplate.CSharp.zip" KeyPath="yes" />
                        </Component>
                        <Component Id="VS2008.MbUnit3.MvcWebApplicationTestProjectTemplate.CSharp.zip" Guid="{6C15FBB6-E0C7-47f4-B7F6-08FC428AD775}">
                            <File Id="VS2008.MbUnit3.MvcWebApplicationTestProjectTemplate.CSharp.zip" Source="$(var.GallioTargetDir)\extras\Templates\VS2008\ProjectTemplates\CSharp\Test\MbUnit3.MvcWebApplicationTestProjectTemplate.CSharp.zip" KeyPath="yes" />
                            <RegistryKey Action="createAndRemoveOnUninstall" Root="HKLM" Key="SOFTWARE\Microsoft\VisualStudio\9.0\MVC\TestProjectTemplates\MbUnit3\C#">
                                <RegistryValue Type="string" Name="Path" Value="CSharp\Test" />
                                <RegistryValue Type="string" Name="Template" Value="MbUnit3.MvcWebApplicationTestProjectTemplate.CSharp.zip" />
                                <RegistryValue Type="string" Name="TestFrameworkName" Value="MbUnit v3" />
                                <RegistryValue Type="string" Name="AdditionalInfo" Value="http://www.mbunit.com/" />
                            </RegistryKey>
                        </Component>
                    </Directory>
                </Directory>
                <Directory Id="VS90.ProjectTemplates.VB" Name="VisualBasic">
                    <Directory Id="VS90.ProjectTemplates.VB.Test" Name="Test">
                        <Component Id="VS2008.MbUnit3.TestProjectTemplate.VisualBasic.zip" Guid="{77546593-B0F5-40b9-A02F-FF1D89101498}">
                            <File Id="VS2008.MbUnit3.TestProjectTemplate.VisualBasic.zip" Source="$(var.GallioTargetDir)\extras\Templates\VS2008\ProjectTemplates\VisualBasic\Test\MbUnit3.TestProjectTemplate.VisualBasic.zip" KeyPath="yes" />
                        </Component>
                        <Component Id="VS2008.MbUnit3.MvcWebApplicationTestProjectTemplate.VisualBasic.zip" Guid="{8B357A10-BBD9-41e0-8C53-FE05B2E693F5}">
                            <File Id="VS2008.MbUnit3.MvcWebApplicationTestProjectTemplate.VisualBasic.zip" Source="$(var.GallioTargetDir)\extras\Templates\VS2008\ProjectTemplates\VisualBasic\Test\MbUnit3.MvcWebApplicationTestProjectTemplate.VisualBasic.zip" KeyPath="yes" />
                            <RegistryKey Action="createAndRemoveOnUninstall" Root="HKLM" Key="SOFTWARE\Microsoft\VisualStudio\9.0\MVC\TestProjectTemplates\MbUnit3\VB">
                                <RegistryValue Type="string" Name="Path" Value="VisualBasic\Test" />
                                <RegistryValue Type="string" Name="Template" Value="MbUnit3.MvcWebApplicationTestProjectTemplate.VisualBasic.zip" />
                                <RegistryValue Type="string" Name="TestFrameworkName" Value="MbUnit v3" />
                                <RegistryValue Type="string" Name="AdditionalInfo" Value="http://www.mbunit.com/" />
                            </RegistryKey>
                        </Component>
                    </Directory>
                </Directory>
            </Directory>

        </DirectoryRef>

        <Feature Id="feat_MbUnit3.Templates.VS2008" Title="Visual Studio 2008 Templates" Level="0" 
                 Description="Installs the MbUnit v3 Visual Studio 2008 templates.">
            <Condition Level="1">
                VS90_ITEMTEMPLATES_DIR and VS90_PROJECTTEMPLATES_DIR
            </Condition>
            <ComponentRef Id="VS90.MbUnit3.TestFixtureTemplate.CSharp.zip" />
            <ComponentRef Id="VS2008.MbUnit3.TestFixtureTemplate.VisualBasic.zip" />
            <ComponentRef Id="VS2008.MbUnit3.TestProjectTemplate.CSharp.zip" />
            <ComponentRef Id="VS2008.MbUnit3.TestProjectTemplate.VisualBasic.zip" />
            <ComponentRef Id="VS2008.MbUnit3.MvcWebApplicationTestProjectTemplate.CSharp.zip" />
            <ComponentRef Id="VS2008.MbUnit3.MvcWebApplicationTestProjectTemplate.VisualBasic.zip" />
        </Feature>

        <!-- ==================================================================== -->

    </Fragment>
</Wix>




