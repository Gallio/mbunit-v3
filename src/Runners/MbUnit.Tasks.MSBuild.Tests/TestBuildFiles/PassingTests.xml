<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <UsingTask AssemblyFile="..\bin\MbUnit.Tasks.MSBuild.dll"
             TaskName="MbUnit" />
  <ItemGroup>
    <TestAssemblies Include="..\..\..\TestResources\MbUnit.TestResources.MbUnit2\bin\MbUnit.TestResources.MbUnit2.dll" />
  </ItemGroup>

  <Target Name="MyTarget">
    <MbUnit IgnoreFailures="true" Filter="Type=PassingTests" 
      Assemblies="@(TestAssemblies)"
    >
      <Output TaskParameter="ExitCode" PropertyName="MbUnitExitCode"/>
    </MbUnit>

    <Error
            Text="The return code should have been $(ExpectedMbUnitExitCode)"
            Condition="'$(MbUnitExitCode)' != $(ExpectedMbUnitExitCode)" />

    <Message Text="MbUnitExitCode=$(MbUnitExitCode)" />
    
  </Target>
</Project>